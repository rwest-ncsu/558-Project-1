---
title: "README"
author: "Robert West"
date: "6/8/2020"
output:  
  rmarkdown::github_document:
    toc: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=F)
knitr::opts_chunk$set(warning=F)
knitr::opts_chunk$set(message=F)
library(ggplot2)
library(jsonlite)
library(tidyverse)
library(knitr)
library(httr)
```

# Describe JSON data. What is it, where does it get used, and why is it a good way to store data? This should be detailed enough that someone that hasn’t seen JSON data would have a good idea what they are dealing with. You should link to references where applicable.

*Java Script Object Notation* (or JSON) is a text-based data format that is used primarily to send and receive data from internet applications. It is so widely used because its text structure makes it much easier to send files. The "issue" that this can bring with it is that you need to convert the text representation of data into an object that R (or any other language) knows how to work with. 






# Discuss the possible packages/functions that are available for reading JSON data into R. (There are three major packages for JSON data.) Choose one and explain why you’ve chosen it.

The package that I chose to work with is the `jsonlite` package. I chose this because it offers the functionality to return a nested list as a data frame without parsing the data yourself. 






To get a feel for handling JSON data, let's communicate with an API (Application Programming Interface) for the NHL. The URL for accessing the API is saved below and a function for requesting Franchise information is provided to make code more readable. In this function, I utilize: 

* httr::GET() to access a given web address 
* httr::content() to turn the output into a text file 
* jsonlite::fromJSON() to turn the text file into a data frame(with flatten=TRUE)

To access more data from the API, I wrote 4 more functions extraordinarily similar to the `get_franchises()` function but with different URLs. Every API is different, so to determine how to request the right information, you need to read the [documentation](https://gitlab.com/dword4/nhlapi/-/blob/master/records-api.md). 
```{r, echo=T}
base_url = "https://records.nhl.com/site/api"
```



```{r, echo=T}
get_franchises = function(){
  library(jsonlite)
  full_url = paste0(base_url, "/franchise")
  text = content(GET(url=full_url), "text") #Converts the JSON output from the API to a text file
  list_output = fromJSON(text, flatten = T)
  
  return(list_output$data)
}
```



```{r}
get_franchise_totals = function(){
  library(jsonlite)
  full_url = paste0(base_url, "/franchise-team-totals")
  text = content(GET(url=full_url), "text")
  list_output = fromJSON(text, flatten = T)
  
  return(list_output$data)
}
```



```{r}
get_season_records = function(id){
  library(jsonlite)
  full_url = paste0(base_url, "/franchise-season-records?cayenneExp=franchiseId=", id)
  text = content(GET(full_url), "text")
  list_output = fromJSON(text, flatten=T)
  
  return(list_output$data)
}
```



```{r}
get_goalie_records = function(id){
  library(jsonlite)
  full_url = paste0(base_url, "/franchise-goalie-records?cayenneExp=franchiseId=", id)
  text = content(GET(full_url), "text")
  list_output = fromJSON(text, flatten=T)
  
  return(list_output$data)
}
```



```{r}
get_skater_records = function(id){
  library(jsonlite)
  full_url = paste0(base_url, "/franchise-skater-records?cayenneExp=franchiseId=", id)
  text = content(GET(full_url), "text")
  list_output = fromJSON(text, flatten = T)
  
  return(list_output$data)
}
```


Now that we can communicate with the API and can load the data into a data frame, let's explore!
```{r, echo=T}
id=26 #Go Canes

franchises = get_franchises()
franchise_totals = get_franchise_totals()
season_records = get_season_records(id)
goalie_records = get_goalie_records(id)
skater_records = get_skater_records(id)
```































